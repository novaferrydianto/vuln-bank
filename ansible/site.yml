---
# ============================================================
# 1. INFRASTRUCTURE SETUP (Bastion + DB + Hosting + Monitoring)
# ============================================================
- import_playbook: playbooks/setup_bastion.yml
- import_playbook: playbooks/setup_db.yml
- import_playbook: playbooks/setup_hosting.yml
- import_playbook: playbooks/setup_monitoring.yml

# ============================================================
# 2. CIS HARDENING (Balanced Profile + OpenSCAP)
# ============================================================
- import_playbook: playbooks/hardening_hosting.yml

# ============================================================
# 3. OPENSCAP SCORING VALIDATION
# (Uses --extra-vars "cis_min_score=XX")
# ============================================================
- import_playbook: playbooks/verify_openscap.yml

# ============================================================
# 4. APPLICATION DEPLOYMENT (VM2 + VM3 via Docker Compose)
# ============================================================
- import_playbook: playbooks/deploy_app.yml

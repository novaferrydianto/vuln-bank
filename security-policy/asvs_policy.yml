asvs_version: "4.0"

app_profile:
  name: vuln-bank
  target_level: 2           # L1 | L2 | L3
  environment: production

blocking_rules:
  - id: ASVS-CRITICAL-ACCESS
    description: >
      Block release when exploitable Access Control violations exist
    match:
      asvs:
        - V4                  # Access Control
      severity:
        - HIGH
        - CRITICAL
      exploitable: true
    action: BLOCK

  - id: ASVS-AUTHN-CRITICAL
    description: Authentication control broken
    match:
      asvs:
        - V2
      severity:
        - CRITICAL
    action: BLOCK

  - id: ASVS-SECRETS
    description: Secrets exposure
    match:
      asvs:
        - V14
      severity:
        - HIGH
        - CRITICAL
    action: BLOCK

warn_rules:
  - id: ASVS-CRYPTO
    match:
      asvs:
        - V7
    action: WARN

  - id: ASVS-INPUT
    match:
      asvs:
        - V5
    action: WARN

baseline_policy:
  allow_baseline: true
  baseline_expires_days: 180

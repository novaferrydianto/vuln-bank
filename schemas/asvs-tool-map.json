{
  "version": "4.0",
  "methodology": "OWASP ASVS â†’ Tool Signal Mapping",
  "scoring": {
    "pass": 1,
    "partial": 0.5,
    "fail": 0
  },
  "weights": {
    "zap": 1.2,
    "semgrep": 1.0,
    "bandit": 0.7,
    "trivy": 1.0,
    "gitleaks": 2.0
  },
  "controls": [
    {
      "id": "V2.1.1",
      "title": "Verify authentication strength",
      "level": "L2",
      "owasp": ["A07"],
      "automation": "auto",
      "tools": [
        {
          "tool": "semgrep",
          "rules": ["python.jwt.decode.no_verify", "python.jwt.missing_audience"],
          "severity_fail": ["HIGH", "CRITICAL"]
        },
        {
          "tool": "bandit",
          "rules": ["B105", "B106"],
          "severity_fail": ["HIGH"]
        }
      ],
      "decision": {
        "fail_if_any": true
      }
    },
    {
      "id": "V3.1.1",
      "title": "Verify session cookies are secure",
      "level": "L1",
      "owasp": ["A02"],
      "automation": "auto",
      "tools": [
        {
          "tool": "zap",
          "rules": ["Cookie No HttpOnly Flag", "Cookie No Secure Flag"],
          "severity_fail": ["MEDIUM", "HIGH"]
        }
      ],
      "decision": {
        "fail_if_any": true
      }
    },
    {
      "id": "V5.1.1",
      "title": "Verify input is validated",
      "level": "L2",
      "owasp": ["A03"],
      "automation": "auto",
      "tools": [
        {
          "tool": "semgrep",
          "rules": ["sql-injection", "xss"],
          "severity_fail": ["HIGH", "CRITICAL"]
        },
        {
          "tool": "zap",
          "rules": ["SQL Injection", "Cross Site Scripting"],
          "severity_fail": ["HIGH"]
        }
      ],
      "decision": {
        "fail_if_any": true
      }
    },
    {
      "id": "V7.1.1",
      "title": "Verify application does not leak stack traces",
      "level": "L1",
      "owasp": ["A09"],
      "automation": "auto",
      "tools": [
        {
          "tool": "bandit",
          "rules": ["B101"],
          "severity_fail": ["MEDIUM", "HIGH"]
        },
        {
          "tool": "zap",
          "rules": ["Application Error Disclosure"],
          "severity_fail": ["MEDIUM", "HIGH"]
        }
      ],
      "decision": {
        "fail_if_any": false,
        "partial_if": "medium_only"
      }
    },
    {
      "id": "V14.1.1",
      "title": "Verify no secrets are committed",
      "level": "L1",
      "owasp": ["A02"],
      "automation": "auto",
      "tools": [
        {
          "tool": "gitleaks",
          "rules": ["generic-api-key", "custom-gcp-api-key"],
          "severity_fail": ["HIGH", "CRITICAL"]
        }
      ],
      "decision": {
        "immediate_fail": true
      }
    },
    {
      "id": "V14.2.1",
      "title": "Verify dependencies are free from known vulns",
      "level": "L2",
      "owasp": ["A06"],
      "automation": "auto",
      "tools": [
        {
          "tool": "trivy",
          "rules": ["SCA"],
          "severity_fail": ["CRITICAL"],
          "epss_threshold": 0.5,
          "kev_block": true
        }
      ],
      "decision": {
        "fail_if_kev": true,
        "trend_sensitive": true
      }
    },
    {
      "id": "V2.5.1",
      "title": "Verify MFA is enforced",
      "level": "L3",
      "owasp": ["A07"],
      "automation": "manual",
      "tools": [],
      "decision": {
        "manual_review_required": true
      }
    }
  ]
}
